{"componentChunkName":"component---src-templates-post-jsx","path":"/sync-exam/","result":{"data":{"site":{"siteMetadata":{"title":"hongo"}},"markdownRemark":{"id":"9bf2c6c3-9f60-5a55-98d1-e060211c8163","excerpt":"Semaphore disable/enable interrupt wait()와 signal()이 실행중일때 다른 프로세스가  S value에 접근하는 것을 막기위해 를 수행한다 아래 사진 잘못됨 >=  싱글 cpu에서만 사용되는 방법. 멀티 cpu에서는 안됨 멀티 cpu에서는 TAS를 사용하는 방법이 있음 근데 사실 TAS쓰면 busy waiting초래해서…","html":"<h2>Semaphore</h2>\n<h3>disable/enable interrupt</h3>\n<ul>\n<li>wait()와 signal()이 실행중일때 다른 프로세스가  S value에 접근하는 것을 막기위해 <code class=\"language-text\">disable/enable interrupt</code>를 수행한다</li>\n</ul>\n<p>아래 사진 잘못됨 >=</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/07220/wait-signal.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA90lEQVQoz4WR227DIBBE+f9vbJs46UW1gzFgczMwWcCJ6lpVR1otD4fZHWDd9QMvrydcqPcDhw8RRTnnZxX1/YDz5R3n7oq3U4fPr29MUh9YxkeJGxfQs6lmYW2GDz0MvQ/g41RZqWY4T2zYs0VMKkXQSMUhxASlCXYeZlnIxDfTzVhKCU7sNLVe7hpjsBBrra3FlDY0WWE2HosNMG5FTAkpRiTqP7cUFHG4CXChoBcH64mNiaqxpTOldI2TUnkDYLt7iLyugTZUFDXQmQxyPrA1snGBJkW4kGi7WN+mmew/pUwvCZxPlbUbm36xDH8o78bnZ/z/2DuleyPrhqlUrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='wait signal' title='wait signal' src='/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/ca1dc/wait-signal.png' srcset='/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/e7570/wait-signal.png 170w,\n/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/f46e7/wait-signal.png 340w,\n/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/ca1dc/wait-signal.png 680w,\n/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/02d09/wait-signal.png 1020w,\n/hgo641/blog/static/6453422c16169f3c8e040b6b81de2c1e/07220/wait-signal.png 1156w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>싱글 cpu에서만 사용되는 방법. 멀티 cpu에서는 안됨</p>\n<ul>\n<li>멀티 cpu에서는 TAS를 사용하는 방법이 있음</li>\n<li>근데 사실 TAS쓰면 busy waiting초래해서 크리티컬 섹션에 진입을 많이하면 cpu 오버헤드가 발생할 수도 있음</li>\n</ul>\n</li>\n<li>wait()와 signal()은 커널레벨에서 실행중</li>\n</ul>\n<blockquote>\n<p> 근데 커널 레벨에서는 어차피 컨텍스트 스위칭이 안되는게 아닌가? 왜 disable/enable interrupt를 할까?</p>\n<p>시스템콜 : 소프트 레벨 인터럽트 - 하던일을 멈추고 os한테 권한이 넘어감. </p>\n<ul>\n<li>어떤 프로세스가 시스템콜을 호출하면 모드가 커널모드로 바뀌는 것 뿐. os한테 작업이 넘어가는건 아니고 os의 권한을 빌려서 시스템콜에 대응되는 작업을 하는 것뿐임. 커널의 권한을 가지는 것.</li>\n<li>그래서 disable/enable interrupt해줘야함</li>\n</ul>\n</blockquote>\n<h3>Semaphore의 단점</h3>\n<ul>\n<li>\n<p>구조화 되어있지않음</p>\n<ul>\n<li>wait -> signal 을 해야하는데</li>\n<li>저 방식으로 안하고 엉뚱하게 해도 체크하지못한다 (signal -> wait, wait -> wait)</li>\n<li>잘못 설계하더라도 알아챌 방법이 없다</li>\n<li>이 문제를 monitor가 해결해줄 수 있다!</li>\n</ul>\n</li>\n<li>데드락과 starvation이 생길 수 있다</li>\n</ul>\n<h2>Monitor</h2>\n<ul>\n<li>\n<p>동기</p>\n<ul>\n<li>Semaphore는 unstructured - too low level, bug 유발가능</li>\n<li>좀 더 high level의 mutual exclusion 필요</li>\n</ul>\n</li>\n<li>OS가 제공하는건 아니고 언어, 랭귀지 - 컴파일러레벨에서 지원</li>\n<li>\n<p>Abstract data type (ADT)</p>\n<ul>\n<li>함수에 의해서만 안에 있는 변수들에 접근 가능</li>\n</ul>\n</li>\n<li>모니터안에서는 하나의 프로세스만 active될 수 있다</li>\n</ul>\n<p>구조</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/737c3/monitor-structure.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 27.647058823529413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA70lEQVQY021Qi07DMAzs/38bQmJ0Ha+A6DbBmqSvtEsfcQ4nezAqrJxsR+fT2YkHYNoWpqlh+v4KOwz4E97z81iGP/9HcJ/4zkBmj9iuU4jVA/JNhtf7O+RCQCqFoihQleVVgLQElQp+HEF9Bxf6umKcOAnJA2yp8f0uoN5eYA5f6NmtZZcDu5znGY4I3lpQpUFtA2qqKOjDP7lzppMgxgFGyehs//yEWmscmTwFIed+V+Pa3/T/RbhIEoqOV9qlK+w3axRZCvUhUOSfOLKrkcWDyziwvNkCgREF4xA7nUOeGLzqxCBeI+BCvs2XeokfoKXSVo3DNewAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='monitor structure' title='monitor structure' src='/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/ca1dc/monitor-structure.png' srcset='/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/e7570/monitor-structure.png 170w,\n/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/f46e7/monitor-structure.png 340w,\n/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/ca1dc/monitor-structure.png 680w,\n/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/02d09/monitor-structure.png 1020w,\n/hgo641/blog/static/92c816d29a9cf120223b5593c38b565d/737c3/monitor-structure.png 1111w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>두 가지 제약 조건이 있는 class라고 생각하면 됨</p>\n<ol>\n<li><strong>함수에 의해서만 내부 변수에 접근 가능</strong></li>\n<li><strong>외부에서 하나의 프로세스만 들어올 수 있음</strong></li>\n</ol>\n<br/>\n<ul>\n<li>entry queue : 모니터로 들어고자하는 thread의 queue</li>\n<li>\n<p>condition variable - type이 condition인 value</p>\n<ul>\n<li>waiting queue의 일종</li>\n</ul>\n</li>\n</ul>\n<br/>\n<p><strong># Monitor with condition variables</strong></p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/11663/monitor-structure2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 69.41176470588235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB0ElEQVQ4y3VT207jMBDN/3/KvuxKSKuFRdonJFYtlJbSslVuLUmTlm7IzXFiJz3YJhQnhJFGYyf2mTNnxgYG7Hg8nqJyudb2fSsIgeM44IzB6Fwc8DZF62/2EkX4f3iG73lw9zEm9wuMRyP1zxjKqNs+pZj4KUZPMZxDLnAbRBnBg+ni4tc5HD8E1yAUQ845qqpSsa5r1E0D1Bxbkf3STvFj8oSzeYBzO8fMj8X3A4IoE9j1CagRdyQ5BRiJErbbLWzbxnQ6xXQ2g7de4+r3Fb5d/sXPWxPXu0b5nw3FTrBGX9dW607Jcs2EsNLznKDIchFzkJKhqDiKNmaEqkr6DTyVPNQ92TE/COEL5pZlq/KYkMU0LRRF0QP8ADV0sPf4piWH5W6wMm3MHpZIkgQvcYy7+VKxP0qdv2LYnz8psGTobjw47hrLfyvVNCKYLR5XIGLuGg1QBzW+GuqyLJGLi5JNkqQoKAUV37IsA6VdDTuAn15Fu5eMZNmCL6LnPfZhgIZVSi8JOATWaYrOsD2CMM4x3xUYWyFurAD3IYErhrtRifSz729pgKGegNUNFrscZ3cbfB9ZGHsZUso+v3dNskHAPmvGa5SMd8ajXaD/cF8BXy4/3qmChMEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='monitor structure2' title='monitor structure2' src='/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/ca1dc/monitor-structure2.png' srcset='/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/e7570/monitor-structure2.png 170w,\n/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/f46e7/monitor-structure2.png 340w,\n/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/ca1dc/monitor-structure2.png 680w,\n/hgo641/blog/static/bed0a50fb299870029449bb71e6f2d41/11663/monitor-structure2.png 697w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>condition variable인 x와 y가 존재</li>\n<li>x라는 이름의 waiting queue와 y라는 이름의 waiting queue 존재</li>\n<li>x.wait() - 다른 누군가가 x.signal()을 해주기전까지 기다림</li>\n<li>x.signal() - wait한 애를 깨워줌</li>\n</ul>\n<h3>Code Example</h3>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 508px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/ce6482b247fe91ddda5a8c112fc58a8c/7c891/example.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 94.11764705882352%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACE0lEQVQ4y61UaW/iMBDl//+s/bKt1HK2ZVsV0UAOEjvkcMjtvJ0xSxZaFqi0lpzYQfP8jjGDUErMZjMs3t9hWRaiOEYgJGScQG4jbDYbyCiGiCIEYYisKFA1DTqcjq7bfxnwYrVaYTqdYDKZ4GU+R7BewXl7hXRslKFA+esZxWyEcvGKevWBRvioH37u590P6K3sQQe8iInVeDzGcPhoAN/GI/ijByhridZdo5o+ov1YQPse6tE96tnQfNdJbMC0Sk8BedG0DVqaWmto+tZWJTRJ02liCpq1hZYADFAo0ZXFecn8SIjh89MTLJIuZQjXdSHIry35thECeVWRn1u4noeKCus/xQxymD3Dwybf7ZBlCn4QGE8FAWndGdYdscahmNb9/ggU+91fwDYKkbo2BDHxfR+CgDlh27axo8Pwj1Q/jx4wVQoeAahUoSKJUbQllgEa8vGzvGOJXwD5cSi6NC6BfAGs6xoppcnSeF1w8xJLniZ19uzEryuAaZpiPn/BcrkkqZEJxHEdOI5rfjuWfW30HpZlCc9zDRiDBGIfSpZlN7PrGbZtizzPTeuE3H+UdJKQBfTtXCD/JZSb2+YQiqLrxSwVtU9KrZOpzDDkYBRZwN7meWEOv8qQJbNntuPQ1ZNGMl8/bmr2NKND+HreDMhtYZhQIYfDe35zIPz+lmQ+kcEuJfitUFhud+bf41zxLW3zGxgjyM5nAUBhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='example' title='example' src='/hgo641/blog/static/ce6482b247fe91ddda5a8c112fc58a8c/7c891/example.png' srcset='/hgo641/blog/static/ce6482b247fe91ddda5a8c112fc58a8c/e7570/example.png 170w,\n/hgo641/blog/static/ce6482b247fe91ddda5a8c112fc58a8c/f46e7/example.png 340w,\n/hgo641/blog/static/ce6482b247fe91ddda5a8c112fc58a8c/7c891/example.png 508w' sizes='(max-width: 508px) 100vw, 508px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>boolean busy - 리소스가 현재 사용중인지 아닌지</p>\n<ul>\n<li>초기화값은 false</li>\n</ul>\n</li>\n<li>\n<p>acquire </p>\n<ul>\n<li>busy가 false이면 busy를 true로 바꾸고 바로 크리티컬 섹션 진입</li>\n<li>busy가 true이면 wait()하고 signal()로 깨어나면 busy를 true로 바꾸고 크리티컬 섹션 진입</li>\n</ul>\n</li>\n<li>\n<p>release</p>\n<ul>\n<li>signal을 날려서 x를 깨워줌</li>\n</ul>\n</li>\n<li>\n<p>유저가 유저레벨에서 동기화 코드를 작성한게 됨</p>\n<ul>\n<li>disable/enable같은 툴 안쓰고 유저레벨에서 동기화 문제 해결 가능</li>\n</ul>\n</li>\n</ul>\n<h3>Condition variable choices</h3>\n<p>ex) 만약 Process P가 x.signal()을 하고 Process Q가 x.wait()를 했었다면 어떻게 해야할까?  </p>\n<p><strong>1. Signal and wait</strong></p>\n<ul>\n<li>P는 Q가 자신의 일을 마치고 나올때까지 기다린다 (우리는 이걸로 한다고 가정)</li>\n</ul>\n<p><strong>2. Signal and Continue</strong></p>\n<ul>\n<li>반대로 P는 계속 주어진 일을 마저 하고 P가 모니터를 빠져나와서야 Q가 시작된다</li>\n</ul>\n<h3>Monitor Implementation</h3>\n<p>세 개의 큐가 필요 + 각각의 큐에 들어가기 위해 큐를 컨트롤하는 세마포어 lock이 존재 </p>\n<ul>\n<li>\n<p>monitor queue - monitor 출입 관리 (= entry queue)</p>\n<ul>\n<li>monitor lock</li>\n</ul>\n</li>\n<li>\n<p>condition var의 queue - 특정 공유 변수 접근 권한을 갖기위한 큐</p>\n<ul>\n<li>x_sem</li>\n</ul>\n</li>\n<li>\n<p>signal and wait 를 할 때 signal()을 하고 기다릴 프로세스의 대기 queue</p>\n<ul>\n<li>sig_lock</li>\n</ul>\n</li>\n</ul>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/6e70f/lock-example.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 71.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABuUlEQVQ4y4VSi3KCMBDk/79Mx1orggoI+ODlY4Cqo86o2d4dBqxaGydcEpO9vb01LleF2WyGbvcTvV4Pw+EQ0+lU9kEQwrYtOc+yDEopXK9XiefzWdaXy6WOfG7QFwpAHCdot1pot9sYjUcEFmA0qqLrupJ0sVhgvV7T3Ri2ZcGfTDC0bSRJgt1uK0kMRuWRphk+Oh2ZE7o48Txh6zgOzMEA+/1ewFarFQFGCMNQkuR5jrIsBUMY8ud0OglDfZEBOTtH13Xg+z49KqTsw+GA4/EobO6HJmawhlyWRSWEYQBnPIbZ7xNIgDiK4BFTl1jKHWLa73+JrvP5XED0rBnyggWNSB/WhhvCcbPZCFtm9W5UYEpvGg1PVEYcxaRJgfK7FM3uu6ofP876nH+0bQBJR2az3W6pY7tfGr1+rOo1bmC8rkvmbnHXxqShRzYJAh+maSKQhpTC/CVLqN8M9aWUvGRblaeWy6XomKYpiiJ/6mQFVkmn9PktQQ3I/mLfMUhE3WVA9h1PZs6SPJZfFanBq+KN5k+Iv7TPeDKIjtyce5aakaaqdJefs/5nETQ2gS65OTLeWeIvi7wbPzALM1OhVixlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='lock example' title='lock example' src='/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/ca1dc/lock-example.png' srcset='/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/e7570/lock-example.png 170w,\n/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/f46e7/lock-example.png 340w,\n/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/ca1dc/lock-example.png 680w,\n/hgo641/blog/static/6bda63da285584a2b8f1b1141b900d6f/6e70f/lock-example.png 733w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>wait(monitor_lock)</p>\n<ul>\n<li>누군가 모니터락을 해제하기전까지는 대기</li>\n<li>모니터락이 false면 다음라인(body) 수행</li>\n</ul>\n</li>\n<li>모니터락에서 누군가 일을 끝내면 기다리고있는 다음 순번을 깨워준다. 다음 순번은 sig_lock에 있는애가 되거나 모니터락에 있는 애가 될 수 있다.</li>\n<li>\n<p>if (sig<em>lock</em>count > 0)</p>\n<ul>\n<li>시그 락 카운트가 양수라면 수행하다가 signal()을 호출해서 쫓겨난 프로세스가 있다는 의미. 얘네를 먼저 깨워줌</li>\n<li>시그 락 카운트가 0보다 작거나 같다면 모니터락에 있는 애를 깨워준다</li>\n</ul>\n</li>\n</ul>\n<p># 위 사진의 body는 아래 그림을 의미</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 456px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/8d72d3d889460dc6e81909b524a89f18/b87a0/body.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 31.176470588235293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+ElEQVQY032Q3XKDIBCF8/4PWC86rSYZNQjEioDye7pi4mTaTvcGll2+PXtOoMg5o5wpQwiOtm0xTROMMVCzgrEWWmuM4wi7LCWXQlBdI3iPFCOenNMBo0KQHIwPqKo3sGFA05xR1zUGuu/wGW5doamH3+8w9GdDpZ2GjXQA02IRh9sxyZKKru+L2k11CKFAF3pPnAF9i9R8IJ4/kUnpL4VJz4ijLNOsNZBSFmWCVuOco+s69DeGL8rdpUGi3nBtEN4rRNb/sbJb4bsrfErFq82jhfyK5I9Sqrx5H/bhpPRnPDkFmB8eRFrbOYf/Ir8AMg0v3j0Y2/kNCN/R1YBTQNoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='body' title='body' src='/hgo641/blog/static/8d72d3d889460dc6e81909b524a89f18/b87a0/body.png' srcset='/hgo641/blog/static/8d72d3d889460dc6e81909b524a89f18/e7570/body.png 170w,\n/hgo641/blog/static/8d72d3d889460dc6e81909b524a89f18/f46e7/body.png 340w,\n/hgo641/blog/static/8d72d3d889460dc6e81909b524a89f18/b87a0/body.png 456w' sizes='(max-width: 456px) 100vw, 456px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 337px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/fadad6bd53e4acd2f8e85ea3f8821704/f57f1/monitor-example.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 75.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACy0lEQVQ4y21T2XbaMBTkJxLwvjs2XvEONjYGHJac9vStPf3//5heyU1CevowSBbS6M6d0UJRFCRpiqqs0DQljR7atkVV1yjLHLvdDo7tIIkTVFVNe3JEvgJZVqGqDMrfccaCEXZdi/PpiHZXoNutcbleiKhDtkmw3/eIowR13eBwGGlvhTRUoCjqA9En6YL9uK4C35fgeQrc4ghRdzHUJs7nVyLaYuw86OoKT08rCIIASZornEm/knPCMLSQJAbixIKXJrA8B1nmYLPZIM8L1GUI19bgOiYMw4Su67BM5YHsnwqDwEQc6wQDdqBD81Wss4guiXE8HnG9f0e/z3HqA5ynO37//IVp8KEpIhRV/UL8UWEca1SRi6qpsCkyrEOf2uDTZSEZUVOlGdIkgm1bMHQDpqmB9V/9H6Hv6XRQRRQ52Pc9N6KpKliWRbDJ3Zyc77DbthCFFURJoh7KHBLNH3u5UCQRdtzAihrkkYi6KjAMI7KcIrNtMBwOpCBERLFhcZqmCSnFjPUyyyvcpwKmJkB+r5CV/UKxcDwXm1jl2TudzlRVhbIo+AU5kWdZNq+VBakJYFs6pcNDnr5A16RHyRoCCmoSyVSJjnEc8O37D7zd33C7nHFoXbxerrjdb0g3Ge63K/8+9S5816YYyR+xUd6D7YYJIeIwTJOIae66JEunV6JxeWm64SYZhsFjY9M6M0j7MGXGQqHGvhQDvHKEX0+8F8/PT1gulxBEkSBjtVrS2jMP9WpFweZmsHUyiPawM+wSnkNN00kuxSYil0ONnh+9jPFEz+yAYd9i3EcYjxPlcI9+OJJh7CkGKKi3LA1936FrXNTNllyXGCH1MHCwXlN0QhtFkeN6veMwDNyQbeXTQZrXFblaYkvO52RQQeY0TUMmZdjVPo0VjxHvoSx/gklgUhgEgUmWuGQmd/5P4NljEIR5jyjOeWSS/wCuGL7QJ5OcIAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='monitor example' title='monitor example' src='/hgo641/blog/static/fadad6bd53e4acd2f8e85ea3f8821704/f57f1/monitor-example.png' srcset='/hgo641/blog/static/fadad6bd53e4acd2f8e85ea3f8821704/e7570/monitor-example.png 170w,\n/hgo641/blog/static/fadad6bd53e4acd2f8e85ea3f8821704/f57f1/monitor-example.png 337w' sizes='(max-width: 337px) 100vw, 337px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h4>condition variable lock</h4>\n<ul>\n<li>\n<p>x_count : 초기값 - 0</p>\n<ul>\n<li>x에 접근하기 위해서 대기하고 있는 스레드 수</li>\n</ul>\n</li>\n<li>\n<p>x_sem : 초기값 - 1</p>\n<ul>\n<li>x semaphore value(자원이 몇 개 있냐)</li>\n</ul>\n</li>\n</ul>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/hgo641/blog/static/f0562a294fada01263243ec877cb7727/1144c/con-var-lock.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAyElEQVQY042R3QqEIBCFe/93K+imWlkvNqIgrYvMtN+zOlEXbcQODKMe/eYwBtM0YRxHDMNA9Rrbtv2sZ/fGWgutNYwxmOf51IOmacAYA39zurAsC6VvdACuVakOeZ4jSRJ8XPUM7Qz5CIQQCMOQxCzLXKYoy5Icr+t6C/TNoiikd3EcUyqldmDbtuCcQ0iBoijg91JKcntA7oCMvcjEbiSlEZwO03QXqqokoe97GGsegX52/u5eRxoTAbuuQ13XBHn6kH/OnYAvZTjO3XT/IEkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='con var lock' title='con var lock' src='/hgo641/blog/static/f0562a294fada01263243ec877cb7727/ca1dc/con-var-lock.png' srcset='/hgo641/blog/static/f0562a294fada01263243ec877cb7727/e7570/con-var-lock.png 170w,\n/hgo641/blog/static/f0562a294fada01263243ec877cb7727/f46e7/con-var-lock.png 340w,\n/hgo641/blog/static/f0562a294fada01263243ec877cb7727/ca1dc/con-var-lock.png 680w,\n/hgo641/blog/static/f0562a294fada01263243ec877cb7727/1144c/con-var-lock.png 955w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>wait() : 기다렸다가 lock검 - 어떤 스레드가 자원 쓰려는데 이미 누가 쓰고있으면 대기큐에 들어가서 기다리게하는 함수. 다 기다리면 크리티컬 섹션 진입 가능? (자원 쓰고있는 애 없으면 아무일도 안함. 바로 크리티컬 섹션 진입 가능)</li>\n<li>signal() : 해당 lock을 풀어줌 - 어떤 스레드가 자원 다 써서 크리티컬 섹션 나가려는데 나가려는 김에 리소스 쓰려고 대기하는 애가 있다면 겸사 겸사 깨워주는 함수</li>\n<li>\n<p>x_wait : 어떤 스레드가 x라는 자원을 사용하고싶다고하면 대기시킴, 대기하는동안 다른 애들 실행하는듯 (x.signal()이 오면 풀려남)</p>\n<ul>\n<li>x_count++ : x 사용할 스레드 늘어남! 나 x쓸거임! 근데 그 전에 깨워줘야할 애들 있음;ㅎㅎ</li>\n<li>sig_lock된 애 부터 깨워줌</li>\n<li>없으면 monitor 큐에서 대기하는 애 깨워줌</li>\n<li>앞에 애들 다 확인했으니까 x하려고 기다리고 있는애 wait()해줌?</li>\n</ul>\n</li>\n<li>\n<p>x_signal : 어떤 스레드가 x라는 자원을 기다리고있다면 사용하도록 허락 (= <strong>x.wait()한 프로세스가 있다면 걔 다시 시작함</strong>), 기다리는 애 없으면 아무 일도 안함</p>\n<ul>\n<li>x_count가 양수라면 x를 사용하기위해 대기중인 스레드가 있다는 말 (너 x 써라!)</li>\n<li>sig<em>lock</em>count++ : x<em>signal()을 호출한 스레드는 자리를 양보해줘야함. 호출한 애는 sig</em>lock되어있어라~</li>\n<li>signal(x<em>sem) : x</em>signal해서 x사용할 애 깨워줘야하니까 x_sem에 있는애한테 얼른 쓰라고 깨워줌</li>\n<li>wait(sig<em>lock) : x</em>signal() 호출한 애는 쫓겨나서 기다려야함. 나중에 x.wait() 누가 해주면 깨어날 수 있음</li>\n<li>위에다 끝나면 sig<em>lock</em>count 다시 마이너스</li>\n</ul>\n</li>\n</ul>\n<h2>리눅스에서 제공하는 Synchronization 기법</h2>\n<p>2.6버전 이후 초창기에는 짧은 크리티컬 섹션에서는 인터럽트를 막고 푸는 기법을 썼다</p>\n<p>최근에는 fully preemptive한 기법을 사용(누군가 중간에 치고 들어올 수 있는)</p>\n<ul>\n<li>대부분이 시스템이 멀티프로세서이기 때문</li>\n<li>TAS를 사용해서 spin lock(busy waiting)이 걸리는 형태로</li>\n</ul>\n<p>Semaphores 제공</p>\n<p>Atomic integers 제공 : 사용자 수준에서 TAS를 사용하기쉽게 변수 타입과 함수들 제공 - atomic 오퍼레이션을 통해서 접근을 하면 다른 애들은 접근을 못하게하는 기능 제공, 간단한 크리티컬 섹션 제어에 사용(변수 하나), 동시에 여러 개의 변수 권한을 설정하려면 세마포어 사용</p>\n<p>atomic_t  : 동시에 여러명이 접근할 수 없는 integer이다</p>","frontmatter":{"title":"os 10-2 Synchronization Examples","date":"June 02, 2022","update":null,"tags":["OS"],"series":null},"fields":{"slug":"/sync-exam/","readingTime":{"minutes":9.53}}},"seriesList":{"edges":[{"node":{"id":"1f4e5238-73be-5807-a94c-f4de69b70d29","fields":{"slug":"/git1/"},"frontmatter":{"title":"git pull 오류 : fatal: refusing to merge unrelated histories"}}},{"node":{"id":"a18a1199-15b8-567b-b381-9877cb7e1482","fields":{"slug":"/flex/"},"frontmatter":{"title":"flex 해보기 ㅎㅎ"}}},{"node":{"id":"dcd66e70-19bb-529a-93eb-a40dcda3967d","fields":{"slug":"/meta-class/"},"frontmatter":{"title":"Django의 Meta 클래스 활용"}}},{"node":{"id":"9ba353f1-cdcf-5911-a0bd-05ab1ab2c88e","fields":{"slug":"/alpha-beta-pruning/"},"frontmatter":{"title":"Minimax 알고리즘 & alpha-beta 가지치기"}}},{"node":{"id":"7f18986d-bd27-5ec2-9316-919595eca11b","fields":{"slug":"/6-2/"},"frontmatter":{"title":"os 6-2"}}},{"node":{"id":"3dfd35bf-9f06-57e0-8aae-bbe57bac7616","fields":{"slug":"/grid/"},"frontmatter":{"title":"그리드를 어떻게 그리드라"}}},{"node":{"id":"3e388686-2418-5776-a4f4-7d485967ad50","fields":{"slug":"/instance-flex/"},"frontmatter":{"title":"장고하다가 모델 인스턴스 뻥튀기 하고싶을때"}}},{"node":{"id":"35cb486b-c0aa-5492-bf01-368334b4e4d5","fields":{"slug":"/datamining/"},"frontmatter":{"title":"작성중"}}},{"node":{"id":"d8cb2c75-c4f1-5607-9036-fdfb429643bd","fields":{"slug":"/7-2/"},"frontmatter":{"title":"os 7-2"}}},{"node":{"id":"5e929406-a010-55f2-8762-1f8c050eaf4c","fields":{"slug":"/7-1/"},"frontmatter":{"title":"os 7-1"}}},{"node":{"id":"58f895f6-cc6d-51eb-b09a-0eade39b1e41","fields":{"slug":"/8-1/"},"frontmatter":{"title":"os 8-1"}}},{"node":{"id":"3b144405-2ae5-5814-a3eb-f3db08d57801","fields":{"slug":"/auth-user/"},"frontmatter":{"title":"AUTH_USER_MODEL 사용"}}},{"node":{"id":"a1a1c386-4e12-55c0-b88e-b1ab29cfc979","fields":{"slug":"/sync-tools/"},"frontmatter":{"title":"os 10-1 Synchronization Tools"}}},{"node":{"id":"a8468bab-91a9-5069-bc3f-049d1a5aceb9","fields":{"slug":"/env/"},"frontmatter":{"title":"SECRET KEY 환경변수에 숨기기"}}},{"node":{"id":"85ca9819-7740-5d19-bde1-f1825944fb23","fields":{"slug":"/11-1/"},"frontmatter":{"title":"os 11-1"}}},{"node":{"id":"fe1864b8-839f-505a-8647-10db01ebd21a","fields":{"slug":"/11-2/"},"frontmatter":{"title":"os 11-2"}}},{"node":{"id":"641a26c1-7a3f-591a-9294-2b8a329ef9a6","fields":{"slug":"/list-comprehension/"},"frontmatter":{"title":"list comprehension"}}},{"node":{"id":"8e10d9c5-ccdf-5fb1-9389-4a7d2618115c","fields":{"slug":"/zip/"},"frontmatter":{"title":"zip"}}},{"node":{"id":"232934ea-695b-59c3-9933-f70434f65675","fields":{"slug":"/access-token/"},"frontmatter":{"title":"git access token 발급 잔디 테스트"}}},{"node":{"id":"4692c2dc-2ae0-58ba-92be-fc345d912b43","fields":{"slug":"/requests/"},"frontmatter":{"title":"python 라이브러리 requests"}}},{"node":{"id":"a49c908d-fe72-5ab8-aeca-835d60f50497","fields":{"slug":"/docker-concept/"},"frontmatter":{"title":"docker 개념"}}},{"node":{"id":"756b4f22-d300-58fe-8d33-fafc6ff511f6","fields":{"slug":"/docker-env/"},"frontmatter":{"title":"docker env설정(작성중ㅎㅎ)"}}},{"node":{"id":"d6ccffc2-7b03-5581-b29a-ac306dc06194","fields":{"slug":"/jupyter-setting/"},"frontmatter":{"title":"장고 shell 명령 주피터에서 할 때 초기세팅"}}},{"node":{"id":"254cabc8-767a-509a-8ac6-1b7c1fee5877","fields":{"slug":"/install-openssl/"},"frontmatter":{"title":"ubuntu에서 openssl 설치하기"}}},{"node":{"id":"7b7a0020-f454-5945-885b-8972512e0d8e","fields":{"slug":"/ssl-concept/"},"frontmatter":{"title":"ssl 인증서란?"}}},{"node":{"id":"9bf2c6c3-9f60-5a55-98d1-e060211c8163","fields":{"slug":"/sync-exam/"},"frontmatter":{"title":"os 10-2 Synchronization Examples"}}},{"node":{"id":"910aa000-d355-501d-a941-b234944b4fec","fields":{"slug":"/bash/"},"frontmatter":{"title":"bash: vi: command not found"}}},{"node":{"id":"02483ae7-ba0a-5e03-aa72-19a907837984","fields":{"slug":"/2/"},"frontmatter":{"title":"os 13-2"}}},{"node":{"id":"4bec6f60-3a0e-5050-b6c4-1a9d7a232ba4","fields":{"slug":"/1/"},"frontmatter":{"title":"os 13-1"}}},{"node":{"id":"ce978a60-290f-5fbb-b75d-f9ec9e6f57e2","fields":{"slug":"/1/"},"frontmatter":{"title":"os 12-1"}}},{"node":{"id":"bfc80393-1cd7-5fc8-bc04-e744783e77de","fields":{"slug":"/2/"},"frontmatter":{"title":"os 12-2"}}},{"node":{"id":"e41df5b8-30c6-54fe-88c9-1d212c70c9f4","fields":{"slug":"/15/"},"frontmatter":{"title":"os 14-2"}}},{"node":{"id":"a8eb5fd5-89bd-592a-bbbd-81ff257715b2","fields":{"slug":"/1/"},"frontmatter":{"title":"os 14-1"}}},{"node":{"id":"d86a8175-8ed2-572f-9679-d8d2a48d0697","fields":{"slug":"/2/"},"frontmatter":{"title":"os 14-2"}}},{"node":{"id":"b2e15c0a-3e85-5d09-bb9a-930a3af8456a","fields":{"slug":"/kr-str/"},"frontmatter":{"title":"[c++] 한글을 한 글자씩 출력하기"}}},{"node":{"id":"ad012487-5365-57df-8a83-b70be15aa316","fields":{"slug":"/arr-addr/"},"frontmatter":{"title":"arr과 &arr의 차이"}}},{"node":{"id":"5063006c-e0ec-58ad-bbd0-0e5f2ab7ad99","fields":{"slug":"/git2/"},"frontmatter":{"title":"git error: cannot lock ref 'refs/remotes/origin/main': unable to resolve reference 'refs/remotes/origin/main': reference broken 문제 해결"}}}]},"previous":{"fields":{"slug":"/3-script-basic/"},"frontmatter":{"title":"멋쟁이사자처럼 X 넥슨 MOD Suppoters Hackathon 3주차 회고"}},"next":{"fields":{"slug":"/4-event-basic/"},"frontmatter":{"title":"멋쟁이사자처럼 X 넥슨 MOD Suppoters Hackathon 4주차 회고"}}},"pageContext":{"id":"9bf2c6c3-9f60-5a55-98d1-e060211c8163","series":null,"previousPostId":"4651183f-7a49-5a8c-82b2-d6f481f153df","nextPostId":"d48cdf2d-4418-57ac-bbb6-df5cfde75b53"}},"staticQueryHashes":[]}